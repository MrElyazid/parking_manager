<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.VBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.layout.HBox?>
<?import javafx.geometry.Insets?>
<?import com.smartparking.model.Reservation?> <!-- Import model for TableView type -->
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import java.lang.Integer?> <!-- For Integer type -->
<?import java.lang.String?>  <!-- For String type -->
<?import java.lang.Double?>  <!-- For Double type -->


<VBox xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.smartparking.controller.AdminPanelController"
      spacing="15" alignment="TOP_CENTER" styleClass="admin-panel">

    <padding>
        <Insets top="20" right="30" bottom="20" left="30"/>
    </padding>

    <Label text="Admin Panel - Manage Reservations" style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #4a4a8a;"/>

    <TableView fx:id="reservationsTable" prefHeight="400" VBox.vgrow="ALWAYS">
        <columns>
            <!-- Use fx:id to allow controller injection if needed -->
            <TableColumn fx:id="reservationIdColumn" text="Res ID" prefWidth="70">
                 <cellValueFactory><PropertyValueFactory property="reservationId" /></cellValueFactory>
            </TableColumn>
             <TableColumn fx:id="userIdColumn" text="User ID" prefWidth="70"> <!-- Added User ID -->
                 <cellValueFactory><PropertyValueFactory property="userId" /></cellValueFactory>
            </TableColumn>
            <TableColumn fx:id="spotIdColumn" text="Spot ID" prefWidth="80">
                 <cellValueFactory><PropertyValueFactory property="spotId" /></cellValueFactory>
            </TableColumn>
            <TableColumn fx:id="startTimeColumn" text="Start Time" prefWidth="160">
                 <!-- Use the formatted getter method from Reservation model -->
                 <cellValueFactory><PropertyValueFactory property="formattedStartTime" /></cellValueFactory>
            </TableColumn>
             <TableColumn fx:id="endTimeColumn" text="End Time" prefWidth="160">
                 <cellValueFactory><PropertyValueFactory property="formattedEndTime" /></cellValueFactory>
            </TableColumn>
             <TableColumn fx:id="priceColumn" text="Price" prefWidth="90">
                 <cellValueFactory><PropertyValueFactory property="calculatedPrice" /></cellValueFactory>
                 <!-- Custom cell factory applied in controller -->
            </TableColumn>
             <TableColumn fx:id="createdTimestampColumn" text="Booked At" prefWidth="160">
                 <cellValueFactory><PropertyValueFactory property="formattedCreationTimestamp" /></cellValueFactory>
            </TableColumn>
        </columns>
         <!-- Enable column resizing -->
        <columnResizePolicy>
          <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
       </columnResizePolicy>
    </TableView>

    <HBox spacing="10" alignment="CENTER_RIGHT">
        <Button text="Refresh List" onAction="#handleRefresh"/>
        <Button text="Delete Selected" onAction="#handleDelete" styleClass="admin-button"/> <!-- Reuse admin button style for delete -->
        <!-- Add other buttons like "Edit" if needed -->
    </HBox>

</VBox>
